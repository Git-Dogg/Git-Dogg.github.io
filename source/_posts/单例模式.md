---
title: 单例模式
date: 2018-03-24 23:31:43
categories:
	- 雕虫小技
	- 雕虫
tags:
	- 单例模式
	- 设计模式
	- php
---
说到单例模式，最典型的代表就是对数据库的连接，在程序的执行过程中，如果采用类似工厂模式将会产生很多对数据库的连接，这实际上是对资源的一种浪费 ...

<!-- more -->
### **单例模式简述**

在诸多的设计模式中，单例模式是比较常见且比较重要的一种模式，一定要理解。

那么，什么是单例模式？

&emsp;&emsp;单例模式就是在一次程序运行过程中，只允许某一个类实例化出一个对象的一种设计模式，可以避免重复生成一个实例对象而产生的资源浪费，比如对数据库的连接；也可以满足某些特定的需求，比如项目的配置文件类，避免多个地方修改配置引起的冲突。

### **单例模式的核心**
重点：在一次程序执行过程中，只允许产生 **单一对象实体**

单例模式核心就是我们常说的三私一公：
1. 私有化的构造方法（封堵了实例化对象的入口）
2. 私有化的克隆方法（封堵了克隆实例化对象的入口）
3. 私有化的静态变量（承载了单一对象实体）
4. 公有化的静态获取对象实例方法（打开获取对象实例的唯一出口）

##### 解释一下三私一公：
1. 私有化的构造方法将阻止外部实例化对象实体，我们将在本类中采用统一的公有化方法来实例化对象
2. 私有化的克隆方法将阻止外部克隆我们实例化出的对象实体，不然将违背单一对象实体的原则
3. 私有化的静态变量，为了存储单一的对象实体，至于为什么要私有化且静态，看完下面的例子之后说明
4. 公有化的静态方法，获取实例化对象的唯一出口,至于为什么是静态，看完下面的例子之后说明

### **Exp:**
```
<?php 
/**
* 数据库类
*/
class Database
{
	/**
	 * [私有化的静态变量，承载实例化对象]
	 * @var [type]
	 */
	private static $obj;

	/**
	 * [私有化的构造方法]
	 */
	private function __construct()
	{
			
	}

	/**
	 * [私有化的克隆方法]
	 */
	private function __clone()
	{
		
	}

	/**
	 * [公有化的静态方法，获取实例化对象的唯一出口]
	 * @return [object] [实例化对象实体]
	 */
	public static function getInstance()
	{
		if (self::$obj == NULL) 
			self::$obj = new self();
		return self::$obj;
	}

}
?>
```


### **说明:**
1. **获取实例化对象的方法 getInstance() 为何为静态方法?**
	该类禁止外部实例化，即禁止外部进行 new Database() 的操作，那么外部获取对象实体只得通过静态方法调用，所以获取实例化对象的唯一出口 getInstance() 方法必须为静态方法；
2. **承载对象实体的成员变量 $obj 为何为静态变量?**
	对象实体 $obj 由静态方法产生，所以必须为静态的成员变量；
3. **承载对象实体的成员变量 $obj 为何为私有?**
	对象实体 $obj 是静态变量，必须禁止外部对其调用更改，所有必须为私有静态成员变量。



